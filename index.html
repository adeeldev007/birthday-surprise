<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Happy Birthday Gulaboo ‚ù§Ô∏è</title>
    
    <!-- Google Fonts for Cinematic Typography -->
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600&family=Great+Vibes&family=Playfair+Display:ital,wght@0,400;0,600;1,400&family=Montserrat:wght@300;400&display=swap" rel="stylesheet">
    
    <!-- Canvas Confetti Library -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <style>
        /* === CSS Variables & Base Setup === */
        :root {
            --pink: #ff8fab;
            --wine: #5e0b15;
            --cream: #fff5e1;
            --rose-gold: #b76e79;
            --dark-bg: #110103;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: 'Playfair Display', serif;
            background-color: var(--dark-bg);
            color: var(--cream);
            overflow: hidden;
            height: 100vh;
            width: 100vw;
            transition: background-color 2s ease; /* For lights out effect */
        }

        /* === BGM Control === */
        #musicToggle {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 100;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: var(--pink);
            width: 45px;
            height: 45px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            backdrop-filter: blur(5px);
            font-size: 1.2rem;
            transition: all 0.3s ease;
        }

        #musicToggle:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.1);
        }

        /* === Backgrounds & Canvases === */
        #particleCanvas, #roseCanvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            z-index: 0;
            pointer-events: none;
        }
        
        #sparkleCanvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            z-index: 9999; /* Always on top */
            pointer-events: none; /* Let clicks pass through */
        }

        #roseCanvas {
            opacity: 0;
            transition: opacity 2s ease;
        }

        /* === Scene Management === */
        .scene {
            position: absolute;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            opacity: 0;
            pointer-events: none;
            transition: opacity 1.5s ease-in-out, transform 1.5s ease, background 2s ease;
            z-index: 10;
        }

        .scene.active {
            opacity: 1;
            pointer-events: all;
            transform: scale(1);
        }

        .scene.hidden {
            transform: scale(1.1);
        }

        /* === Scene 1: Intro === */
        #scene1 {
            background: radial-gradient(circle at center, #3a030c 0%, #000000 100%);
        }

        .btn-glow {
            background: linear-gradient(135deg, var(--pink), var(--rose-gold));
            color: var(--wine);
            border: none;
            padding: 18px 40px;
            font-size: 1.5rem;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 0 20px rgba(255, 143, 171, 0.6);
            font-family: 'Cinzel', serif;
            font-weight: 600;
            animation: pulse 2s infinite, float 4s ease-in-out infinite;
            transition: all 0.4s ease;
            position: relative;
            overflow: hidden;
        }

        .btn-glow::after {
            content: '';
            position: absolute;
            top: -50%; left: -50%; width: 200%; height: 200%;
            background: rgba(255, 255, 255, 0.2);
            transform: rotate(45deg);
            transition: 0.5s;
            opacity: 0;
        }

        .btn-glow:hover::after {
            opacity: 1;
            transform: rotate(45deg) translate(50%, 50%);
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 15px rgba(255, 143, 171, 0.5); }
            50% { box-shadow: 0 0 35px rgba(255, 143, 171, 0.8), 0 0 10px rgba(255, 255, 255, 0.5); }
            100% { box-shadow: 0 0 15px rgba(255, 143, 171, 0.5); }
        }

        @keyframes float {
            0% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0); }
        }

        /* === Scene 2: Glassmorphism Message === */
        #scene2 {
            background: linear-gradient(135deg, #4a0e2e 0%, #1c0318 100%);
        }

        .glass-card {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 143, 171, 0.2);
            padding: 40px 30px;
            border-radius: 20px;
            text-align: center;
            max-width: 650px;
            width: 90%;
            max-height: 85vh;
            overflow-y: auto;
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
        }

        .typewriter-text {
            font-size: 1.25rem;
            line-height: 1.8;
            font-family: 'Montserrat', sans-serif;
            font-weight: 300;
            color: var(--cream);
            text-shadow: 0 0 10px rgba(255, 245, 225, 0.3);
            white-space: pre-wrap;
            min-height: 400px;
            text-align: left;
        }

        .typewriter-text .highlight {
            color: var(--pink);
            font-family: 'Great Vibes', cursive;
            font-size: 2.2rem;
            text-shadow: 0 0 15px rgba(255, 143, 171, 0.6);
        }

        /* === Scene 3: Interactive Question === */
        .question-container {
            opacity: 0;
            margin-top: 30px;
            transition: opacity 1s ease;
        }

        .question-text {
            font-size: 1.5rem;
            font-family: 'Playfair Display', serif;
            font-style: italic;
            margin-bottom: 20px;
            color: var(--pink);
        }

        .btn-group {
            display: flex;
            gap: 20px;
            justify-content: center;
            position: relative;
            height: 50px;
        }

        .btn-secondary {
            background: transparent;
            border: 1px solid var(--pink);
            color: var(--pink);
            padding: 10px 30px;
            border-radius: 30px;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Montserrat', sans-serif;
        }

        .btn-secondary:hover {
            background: rgba(255, 143, 171, 0.1);
        }

        #btnMaybe {
            position: relative;
            z-index: 50;
        }

        /* === Scene 4: Cake & Finale === */
        #scene4 {
            background: radial-gradient(circle at center, #2e0814 0%, #000 100%);
        }

        .cake-title {
            font-family: 'Great Vibes', cursive;
            font-size: 3.5rem;
            color: var(--pink);
            text-shadow: 0 0 20px rgba(255, 143, 171, 0.8), 0 0 5px #fff;
            margin-bottom: 10px;
            text-align: center;
            opacity: 0;
            transform: translateY(-20px);
            transition: all 1.5s ease 0.5s;
        }

        #scene4.active .cake-title {
            opacity: 1;
            transform: translateY(0);
        }

        .cake-container {
            position: relative;
            width: 320px;
            height: 320px;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 30px;
            filter: drop-shadow(0 20px 30px rgba(0,0,0,0.7));
            transition: opacity 2s ease;
        }

        /* SVG Cake Styles */
        .flame {
            transform-origin: center bottom;
            animation: flicker 0.6s ease-in-out infinite alternate;
            transition: opacity 1s ease;
        }

        .flame.extinguished {
            opacity: 0 !important;
            animation: none;
        }

        @keyframes flicker {
            0% { transform: scale(1) rotate(-2deg); fill: #ffcc00; }
            50% { transform: scale(1.1) rotate(2deg); fill: #ff9900; }
            100% { transform: scale(0.9) rotate(-1deg); fill: #ffeb66; }
        }

        .finale-text {
            font-family: 'Great Vibes', cursive;
            font-size: 3.5rem;
            color: var(--pink);
            text-shadow: 0 0 20px rgba(255, 143, 171, 0.5);
            opacity: 0;
            transform: translateY(20px);
            transition: all 2s ease 1s; /* 1s delay */
        }

        .finale-text.show {
            opacity: 1;
            transform: translateY(0);
            animation: breathingGlow 3s infinite alternate;
        }

        @keyframes breathingGlow {
            0% { text-shadow: 0 0 10px rgba(255, 143, 171, 0.4); }
            100% { text-shadow: 0 0 30px rgba(255, 143, 171, 0.9), 0 0 10px rgba(255, 255, 255, 0.5); }
        }

        /* Media Queries for Mobile */
        @media (max-width: 600px) {
            .btn-glow { font-size: 1.2rem; padding: 15px 30px; }
            .typewriter-text { font-size: 1rem; min-height: 480px; line-height: 1.6; }
            .typewriter-text .highlight { font-size: 1.6rem; }
            .cake-title { font-size: 2.5rem; margin-bottom: 5px;}
            .cake-container { width: 260px; height: 260px; margin-bottom: 20px; }
            .finale-text { font-size: 2.8rem; }
            .glass-card { padding: 30px 20px; }
        }
    </style>
</head>
<body>

    <!-- Highly Reliable, Romantic Classical Music -->
    <audio id="bgMusic" loop preload="auto" crossorigin="anonymous">
        <source src="https://cdn.pixabay.com/audio/2022/05/27/audio_1808fbf07a.mp3" type="audio/mpeg">
    </audio>

    <!-- UI Controls -->
    <button id="musicToggle">üîá</button>

    <!-- Canvases -->
    <canvas id="particleCanvas"></canvas>
    <canvas id="roseCanvas"></canvas>
    <canvas id="sparkleCanvas"></canvas> <!-- Magical cursor trail -->

    <!-- SCENE 1: Intro -->
    <section id="scene1" class="scene active">
        <button id="startBtn" class="btn-glow">
            Gulabo ‚ù§Ô∏è<br>
            <span style="font-size: 0.9rem; font-family: 'Montserrat', sans-serif; font-weight: 300;">Click only if you love Adeeeel</span>
        </button>
    </section>

    <!-- SCENE 2 & 3: Message Reveal & Interaction -->
    <section id="scene2" class="scene">
        <div class="glass-card">
            <div id="typewriter" class="typewriter-text"></div>
            
            <div id="questionContainer" class="question-container">
                <div class="question-text">Do you know how special you are?</div>
                <div class="btn-group">
                    <button id="btnYes" class="btn-secondary">Yes ‚ù§Ô∏è</button>
                    <button id="btnMaybe" class="btn-secondary">Maybe</button>
                </div>
            </div>
        </div>
    </section>

    <!-- SCENE 4: Final Birthday Cake -->
    <section id="scene4" class="scene">
        
        <!-- NEW Floating Glowing Title -->
        <div class="cake-title">Happy Birthday Gulaboo ‚ù§Ô∏è</div>

        <div class="cake-container" id="cakeContainer">
            <!-- LUXURY 2-TIER 3D SVG CAKE -->
            <svg viewBox="0 0 300 320" width="100%" height="100%">
                <defs>
                    <linearGradient id="cakeGradBase" x1="0%" y1="0%" x2="100%" y2="0%">
                        <stop offset="0%" stop-color="#ff7597" />
                        <stop offset="50%" stop-color="#ffb6c1" />
                        <stop offset="100%" stop-color="#ff7597" />
                    </linearGradient>
                    
                    <linearGradient id="creamGradBase" x1="0%" y1="0%" x2="100%" y2="0%">
                        <stop offset="0%" stop-color="#fdfbf7" />
                        <stop offset="50%" stop-color="#ffffff" />
                        <stop offset="100%" stop-color="#fdfbf7" />
                    </linearGradient>

                    <linearGradient id="goldStand" x1="0%" y1="0%" x2="100%" y2="0%">
                        <stop offset="0%" stop-color="#bf953f" />
                        <stop offset="25%" stop-color="#fcf6ba" />
                        <stop offset="50%" stop-color="#b38728" />
                        <stop offset="75%" stop-color="#fbf5b7" />
                        <stop offset="100%" stop-color="#aa771c" />
                    </linearGradient>

                    <filter id="glow" x="-20%" y="-20%" width="140%" height="140%">
                        <feGaussianBlur stdDeviation="4" result="blur" />
                        <feComposite in="SourceGraphic" in2="blur" operator="over" />
                    </filter>
                    
                    <!-- Beautiful Red Rose Definition -->
                    <radialGradient id="roseGrad" cx="40%" cy="40%" r="60%">
                        <stop offset="0%" stop-color="#ff1a40"/>
                        <stop offset="50%" stop-color="#c0001a"/>
                        <stop offset="100%" stop-color="#5e000c"/>
                    </radialGradient>
                    <g id="red-rose" transform="scale(0.8)">
                        <!-- Leaves -->
                        <path d="M0,0 Q-15,-10 -20,5 Q-5,15 0,0" fill="#0f3b15"/>
                        <path d="M0,0 Q15,-15 25,-5 Q15,10 0,0" fill="#0f3b15"/>
                        <!-- Flower base -->
                        <circle cx="0" cy="0" r="14" fill="url(#roseGrad)"/>
                        <!-- Inner petals -->
                        <path d="M-8,-2 C-10,-10 5,-12 10,-4 C14,4 5,12 -2,10 C-10,8 -12,2 -8,-2 Z" fill="#d9001d"/>
                        <path d="M-4,2 C-6,-4 2,-8 6,-2 C10,4 2,8 -2,6 C-6,4 -6,0 -4,-2 Z" fill="#ff1a40"/>
                        <path d="M-1,1 C-2,-1 1,-3 3,-1 C4,1 1,3 -1,2 Z" fill="#ff4d6a"/>
                    </g>
                </defs>

                <!-- Elegant Gold Cake Stand -->
                <!-- Base -->
                <ellipse cx="150" cy="290" rx="50" ry="12" fill="url(#goldStand)" />
                <path d="M 100 290 L 105 300 A 45 10 0 0 0 195 300 L 200 290 Z" fill="#8c6214"/>
                <!-- Stem -->
                <path d="M 135 250 L 165 250 L 155 290 L 145 290 Z" fill="url(#goldStand)" />
                <!-- Plate -->
                <ellipse cx="150" cy="250" rx="120" ry="25" fill="#1a050d" />
                <ellipse cx="150" cy="245" rx="115" ry="22" fill="url(#goldStand)" />

                <!-- TIER 1: Bottom Pink Layer -->
                <!-- Main Body -->
                <path d="M 50 180 L 50 240 A 100 20 0 0 0 250 240 L 250 180 Z" fill="url(#cakeGradBase)" />
                <ellipse cx="150" cy="240" rx="100" ry="20" fill="url(#cakeGradBase)" opacity="0.6"/>
                <!-- Top Oval of Tier 1 -->
                <ellipse cx="150" cy="180" rx="100" ry="20" fill="url(#cakeGradBase)" />
                
                <!-- Vanilla Cream Drips for Tier 1 -->
                <path d="M 50 180 Q 60 200 75 180 Q 90 215 110 180 Q 130 205 150 180 Q 170 215 190 180 Q 210 195 230 180 Q 240 205 250 180 L 250 170 A 100 20 0 0 0 50 170 Z" fill="url(#creamGradBase)" />

                <!-- TIER 2: Top White/Cream Layer -->
                <!-- Main Body -->
                <path d="M 85 110 L 85 170 A 65 15 0 0 0 215 170 L 215 110 Z" fill="url(#creamGradBase)" />
                <ellipse cx="150" cy="170" rx="65" ry="15" fill="#e6e4e1" opacity="0.6"/>
                <!-- Top Oval of Tier 2 -->
                <ellipse cx="150" cy="110" rx="65" ry="15" fill="url(#creamGradBase)" />

                <!-- Pink Strawberry Drips for Tier 2 -->
                <path d="M 85 110 Q 95 130 105 110 Q 120 140 135 110 Q 150 135 165 110 Q 180 145 195 110 Q 205 125 215 110 L 215 105 A 65 15 0 0 0 85 105 Z" fill="url(#cakeGradBase)" />

                <!-- Cute Decorative Pearls/Sprinkles around base of Top Tier -->
                <circle cx="95" cy="172" r="2.5" fill="#fff" />
                <circle cx="110" cy="177" r="2.5" fill="#fff" />
                <circle cx="130" cy="181" r="2.5" fill="#fff" />
                <circle cx="150" cy="183" r="2.5" fill="#fff" />
                <circle cx="170" cy="181" r="2.5" fill="#fff" />
                <circle cx="190" cy="177" r="2.5" fill="#fff" />
                <circle cx="205" cy="172" r="2.5" fill="#fff" />

                <!-- Candle 1 -->
                <rect x="110" y="60" width="8" height="45" fill="#fff" rx="2" />
                <line x1="114" y1="60" x2="114" y2="52" stroke="#333" stroke-width="2" />
                <path class="flame f1" d="M 114 30 Q 122 42 114 52 Q 106 42 114 30" fill="#ffcc00" filter="url(#glow)"/>

                <!-- Candle 2 (Center - slightly taller) -->
                <rect x="146" y="45" width="8" height="60" fill="#fff" rx="2" />
                <line x1="150" y1="45" x2="150" y2="37" stroke="#333" stroke-width="2" />
                <path class="flame f2" d="M 150 15 Q 158 27 150 37 Q 142 27 150 15" fill="#ffcc00" filter="url(#glow)"/>

                <!-- Candle 3 -->
                <rect x="182" y="60" width="8" height="45" fill="#fff" rx="2" />
                <line x1="186" y1="60" x2="186" y2="52" stroke="#333" stroke-width="2" />
                <path class="flame f3" d="M 186 30 Q 194 42 186 52 Q 178 42 186 30" fill="#ffcc00" filter="url(#glow)"/>

                <!-- Romantic Red Roses Surrounding the Cake Plate Base -->
                <use href="#red-rose" x="50" y="240" />
                <use href="#red-rose" x="80" y="255" />
                <use href="#red-rose" x="115" y="265" />
                <use href="#red-rose" x="150" y="270" />
                <use href="#red-rose" x="185" y="265" />
                <use href="#red-rose" x="220" y="255" />
                <use href="#red-rose" x="250" y="240" />
                
                <!-- A couple of tiny roses resting on the cake tiers -->
                <use href="#red-rose" x="80" y="200" transform="scale(0.7) translate(30, 80)" />
                <use href="#red-rose" x="190" y="150" transform="scale(0.6) translate(130, 100)" />
            </svg>
        </div>
        
        <button id="blowBtn" class="btn-glow" style="margin-bottom: 20px;">Blow the Candles</button>
        
        <div id="finaleText" class="finale-text">
            Forever yours,<br>
            Adeeeel ‚ù§Ô∏è
        </div>
    </section>

    <!-- JavaScript Logic -->
    <script>
        // === Global Variables & Setup ===
        const bgMusic = document.getElementById('bgMusic');
        const musicToggle = document.getElementById('musicToggle');
        let isMusicPlaying = false;

        // Ensure volume is soft, dreamy
        bgMusic.volume = 0.5;

        // Music Control
        musicToggle.addEventListener('click', () => {
            if (isMusicPlaying) {
                bgMusic.pause();
                musicToggle.innerText = 'üîá';
            } else {
                bgMusic.play();
                musicToggle.innerText = 'üîä';
            }
            isMusicPlaying = !isMusicPlaying;
        });

        // === MAGICAL CURSOR TRAIL (Fairy Dust) ===
        const sparkleCanvas = document.getElementById('sparkleCanvas');
        const sCtx = sparkleCanvas.getContext('2d');
        let sparkles = [];

        function resizeSparkleCanvas() {
            sparkleCanvas.width = window.innerWidth;
            sparkleCanvas.height = window.innerHeight;
        }
        window.addEventListener('resize', resizeSparkleCanvas);
        resizeSparkleCanvas();

        function addSparkle(x, y) {
            sparkles.push({
                x: x,
                y: y,
                size: Math.random() * 3 + 1,
                speedX: (Math.random() - 0.5) * 2,
                speedY: (Math.random() - 0.5) * 2,
                life: 1, // 100% opacity
                decay: Math.random() * 0.02 + 0.015,
                color: `hsl(${Math.random() * 30 + 330}, 100%, 80%)` // Pink/Rose Gold hues
            });
        }

        window.addEventListener('mousemove', (e) => addSparkle(e.clientX, e.clientY));
        window.addEventListener('touchmove', (e) => {
            for(let i=0; i<e.touches.length; i++) {
                addSparkle(e.touches[i].clientX, e.touches[i].clientY);
            }
        });

        function animateSparkles() {
            sCtx.clearRect(0, 0, sparkleCanvas.width, sparkleCanvas.height);
            for (let i = 0; i < sparkles.length; i++) {
                let p = sparkles[i];
                sCtx.globalAlpha = p.life;
                sCtx.beginPath();
                sCtx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
                sCtx.fillStyle = p.color;
                sCtx.shadowBlur = 10;
                sCtx.shadowColor = p.color;
                sCtx.fill();
                
                p.x += p.speedX;
                p.y += p.speedY;
                p.life -= p.decay;

                if (p.life <= 0) {
                    sparkles.splice(i, 1);
                    i--;
                }
            }
            requestAnimationFrame(animateSparkles);
        }
        animateSparkles();

        // === Firefly Particle System (Scene 1 & background) ===
        const canvas = document.getElementById('particleCanvas');
        const ctx = canvas.getContext('2d');
        let width, height, particles;

        function initParticles() {
            width = canvas.width = window.innerWidth;
            height = canvas.height = window.innerHeight;
            particles = [];
            for (let i = 0; i < 70; i++) {
                particles.push({
                    x: Math.random() * width,
                    y: Math.random() * height,
                    r: Math.random() * 2.5 + 0.5,
                    dx: (Math.random() - 0.5) * 0.3,
                    dy: (Math.random() - 0.5) * 0.3,
                    opacity: Math.random(),
                    glowDir: Math.random() > 0.5 ? 1 : -1
                });
            }
        }

        function drawParticles() {
            ctx.clearRect(0, 0, width, height);
            particles.forEach(p => {
                ctx.beginPath();
                ctx.arc(p.x, p.y, p.r, 0, Math.PI * 2);
                ctx.fillStyle = `rgba(255, 204, 153, ${p.opacity})`; // Warm firefly color
                ctx.shadowBlur = 15;
                ctx.shadowColor = "rgba(255, 143, 171, 0.8)";
                ctx.fill();
                ctx.shadowBlur = 0; // Reset for performance
                
                // Move gently
                p.x += p.dx;
                p.y += p.dy;
                
                // Pulse opacity like a firefly
                p.opacity += p.glowDir * 0.01;
                if(p.opacity <= 0.1) { p.opacity = 0.1; p.glowDir = 1; }
                if(p.opacity >= 0.8) { p.opacity = 0.8; p.glowDir = -1; }

                // Wrap around screen
                if (p.x < 0) p.x = width;
                if (p.x > width) p.x = 0;
                if (p.y < 0) p.y = height;
                if (p.y > height) p.y = 0;
            });
            requestAnimationFrame(drawParticles);
        }
        initParticles();
        drawParticles();

        // === Scene Transitions ===
        function switchScene(fromId, toId) {
            document.getElementById(fromId).classList.remove('active');
            document.getElementById(fromId).classList.add('hidden');
            setTimeout(() => {
                document.getElementById(toId).classList.remove('hidden');
                document.getElementById(toId).classList.add('active');
            }, 500); // Wait for fade out
        }

        // === Interaction Logic ===

        // 1. Start Button Click
        document.getElementById('startBtn').addEventListener('click', () => {
            // Force play audio immediately on click to bypass browser restrictions
            bgMusic.play().then(() => {
                isMusicPlaying = true;
                musicToggle.innerText = 'üîä';
            }).catch(error => {
                console.log("Audio play blocked, user must click play icon", error);
            });

            // Soft Heart Explosion
            confetti({
                particleCount: 100,
                spread: 120,
                origin: { y: 0.6 },
                colors: ['#ff8fab', '#5e0b15', '#ffffff'],
                shapes: ['circle'],
                disableForReducedMotion: true
            });

            // Transition
            setTimeout(() => {
                switchScene('scene1', 'scene2');
                document.getElementById('roseCanvas').style.opacity = 1;
                setTimeout(startTypewriter, 1000); // Start typing after scene loads
            }, 800);
        });

        // 2. Typewriter Effect
        const messageLines = [
            "Happy Birthday, meri jaan, meri <span class='highlight'>Gulabo</span> ‚ù§Ô∏è\n\n",
            "Kuch lafz kabhi kaafi nahi hote yeh batane ke liye ki aap mere liye kya ho.\n",
            "Aap meri duaon ka wo asar ho, jo khuda ne sabse khoobsurat waqt par qabool kiya.\n\n",
            "Jab se aap meri zindagi mein aayi hain, har lamha jaise theher sa gaya hai.\n",
            "Aapki woh pyari si muskurahat, aapki choti choti baatein...\n",
            "Yeh sab meri rooh ka sukoon ban chuki hain.\n\n",
            "Main shayad duniya ka sabse khushnaseeb insaan hoon,\n",
            "kyunki mujhe aapka saath mila hai.\n\n",
            "Khuda kare aapki aankhon mein kabhi koi aansu na aaye, siwaye khushi ke.\n",
            "Aur yeh rooh jab tak jism mein hai...\n",
            "Yeh dil sirf aur sirf aapke liye dhadkega.\n\n",
            "Salgirah Mubarak, meri duniya. ‚ù§Ô∏è"
        ];

        async function startTypewriter() {
            const container = document.getElementById('typewriter');
            container.innerHTML = "";
            
            for (let i = 0; i < messageLines.length; i++) {
                let line = messageLines[i];
                // Check if line contains HTML
                if (line.includes("<span")) {
                    container.innerHTML += line;
                    await sleep(800);
                } else {
                    for (let j = 0; j < line.length; j++) {
                        container.innerHTML += line.charAt(j);
                        await sleep(45); // Romantic typing speed
                    }
                    await sleep(600); // Pause at end of line
                }
            }
            
            // Show interaction buttons
            setTimeout(() => {
                document.getElementById('questionContainer').style.opacity = 1;
            }, 1000);
        }

        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        // 3. Catch me if you can (Maybe Button)
        const btnMaybe = document.getElementById('btnMaybe');
        const moveBtn = (e) => {
            const maxX = window.innerWidth - btnMaybe.offsetWidth - 20;
            const maxY = window.innerHeight - btnMaybe.offsetHeight - 20;
            const x = Math.max(20, Math.random() * maxX);
            const y = Math.max(20, Math.random() * maxY);
            
            btnMaybe.style.position = 'fixed';
            btnMaybe.style.transition = 'all 0.3s ease';
            btnMaybe.style.left = `${x}px`;
            btnMaybe.style.top = `${y}px`;
        };

        btnMaybe.addEventListener('mouseenter', moveBtn);
        btnMaybe.addEventListener('touchstart', (e) => {
            e.preventDefault(); 
            moveBtn();
        });

        // 4. Yes Button Click
        document.getElementById('btnYes').addEventListener('click', () => {
            // Heart Rain
            const duration = 3000;
            const end = Date.now() + duration;

            (function frame() {
                confetti({
                    particleCount: 5,
                    angle: 60,
                    spread: 55,
                    origin: { x: 0 },
                    colors: ['#ff8fab']
                });
                confetti({
                    particleCount: 5,
                    angle: 120,
                    spread: 55,
                    origin: { x: 1 },
                    colors: ['#ff8fab']
                });

                if (Date.now() < end) {
                    requestAnimationFrame(frame);
                } else {
                    switchScene('scene2', 'scene4');
                    document.getElementById('roseCanvas').style.opacity = 0;
                }
            }());
        });

        // 5. Blow Candles & Cinematic Finale
        document.getElementById('blowBtn').addEventListener('click', function() {
            // 1. Hide flames
            document.querySelectorAll('.flame').forEach(f => f.classList.add('extinguished'));
            
            // 2. Hide button
            this.style.opacity = 0;
            setTimeout(() => this.style.display = 'none', 500);

            // 3. CINEMATIC LIGHTS OUT EFFECT
            document.body.style.backgroundColor = '#000000'; 
            document.getElementById('scene4').style.background = 'radial-gradient(circle at center, #050002 0%, #000000 100%)';
            document.getElementById('cakeContainer').style.opacity = '0.4'; // Dim the cake slightly
            document.querySelector('.cake-title').style.opacity = '0.6'; // Dim the title slightly

            // Note: Voice code completely removed as requested!

            // 4. Fireworks Confetti (stands out against the black background)
            var duration = 10 * 1000;
            var animationEnd = Date.now() + duration;
            var defaults = { startVelocity: 30, spread: 360, ticks: 60, zIndex: 0 };

            function randomInRange(min, max) {
                return Math.random() * (max - min) + min;
            }

            var interval = setInterval(function() {
                var timeLeft = animationEnd - Date.now();

                if (timeLeft <= 0) {
                    return clearInterval(interval);
                }

                var particleCount = 50 * (timeLeft / duration);
                confetti(Object.assign({}, defaults, { particleCount, origin: { x: randomInRange(0.1, 0.3), y: Math.random() - 0.2 } }));
                confetti(Object.assign({}, defaults, { particleCount, origin: { x: randomInRange(0.7, 0.9), y: Math.random() - 0.2 } }));
            }, 250);

            // 5. Show Glowing Final Message
            setTimeout(() => {
                document.getElementById('finaleText').classList.add('show');
            }, 800);
        });

    </script>
</body>
</html>
